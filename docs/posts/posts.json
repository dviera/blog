[
  {
    "path": "posts/2024-06-13-linearization-techniques-in-optimization-multiplication-of-binary-variables/",
    "title": "Linearization Techniques in Optimization: Multiplication of Binary Variables",
    "description": "Linearization technique for the multiplication of binary variables [@asghari2022transformation].",
    "author": [
      {
        "name": "D.G.",
        "url": {}
      }
    ],
    "date": "2024-06-13",
    "categories": [],
    "contents": "\r\nConsider two binary variables \\(x_i\\) with \\(i \\in \\{1,...,m\\}\\) and \\(y_j\\)\r\nwith \\(j \\in \\{1,...,n\\}\\). To linearize the term \\(x_i·y_j\\), which results\r\nfrom multiplying the binary variables, we replace it with an additional\r\nbinary variable:\r\n\\[z_{ij} = x_i·y_j, \\forall i \\in \\{1,...,m\\}, \\forall j \\in \\{1,...,n\\}\\].\r\nThe model including the non-linear term can be linearized by adding some\r\nnew constraints as follows:\r\n\\[z_{i_j} ≤ x_i, ∀i ∈ \\{1,...,m\\}, ∀j ∈ {\\{1,...,n}\\}\\tag{1}\\]\r\n\\[z_{ij} ≤ y_j, ∀i ∈ \\{1,...,m\\}, ∀j ∈ {\\{1,...,n}\\}\\tag{2}\\]\r\n\\[z_{ij} ≥ x_i + y_j − 1, ∀i ∈ \\{1,...,m\\}, ∀j ∈ {\\{1,...,n}\\} \\tag{3}\\]\r\n\\[z_{ij} ∈ {0, 1}, ∀i ∈ \\{1,...,m\\}, ∀j ∈ {\\{1,...,n}\\}\\tag{4}\\]\r\nApplication: Quadratic Assignment Problem (Nahmias and Olsen 2015)\r\nThe problem is to assign machines to locations. It could be to assign other types of facilities to locations. This problem, unlike the simple assignment problem, is that where I assign one facility will have an impact on the others because there are interactions between facilities such as the number of materials handling trips and the cost of making those trips. We would like to put close facilities that have a lot of interactions.\r\nModel\r\n\\[\\begin{align*}\r\n\r\n&\\text{$n$ = number of machines;}\\\\\r\n\r\n&\\text{$d_{jr}$ = cost of making a single materials handling trip from location $j$ to location $r$;}\\\\\r\n\r\n&\\text{$f_{ik}$ = mean number of trips per time period from machine $i$ to machine $k$;}\\\\\r\n\r\n&x_{ij} =\r\n\\begin{cases}\r\n      1 & \\text{if machine $i$ is assigned to location $j$}\\\\\r\n      0 & \\text{otherwise}\r\n\\end{cases}  \r\n    \r\n\\end{align*}\\]\r\n\\[\\begin{align}\r\n\r\n\\sum_{i=1}^n \\sum_{j=1}^n \\sum_{k=1}^n \\sum_{r=1}^n f_{ik} · d_{jr} · x_{ij} · x_{kr}\r\n\r\n\\\\\r\n\r\n\\sum_{i=1}^n x_{ij} = 1,  \\forall j = 1,...,n\r\n\r\n\\\\\r\n\r\n\\sum_{j=1}^n x_{ij} = 1,  \\forall i = 1,...,n\r\n\r\n\\\\\r\nx_{ij} \\space\\space binary, \\forall i = 1,...,n \\space\\space and \\space\\space \\forall j = 1,...,n\r\n\r\n\\end{align}\\]\r\nImplementation in Julia\r\nExample 10.20 from (Tompkins et al. 2010).\r\n\r\n\r\nusing JuMP\r\nusing CPLEX\r\n# using GLPK\r\n\r\nflow = [0 5 2 0\r\n    0 0 2 3\r\n    3 4 0 0\r\n    0 0 5 0]\r\n\r\ndistance = [0 5 10 4\r\n    4 0 6 7\r\n    8 5 0 5\r\n    6 6 5 0]\r\n\r\nnbFac, nbLoc = size(flow)\r\n\r\nmodel = Model(CPLEX.Optimizer)\r\n# model = Model(GLPK.Optimizer)\r\n\r\n@variable(model, x[1:nbFac, 1:nbLoc], Bin)\r\n\r\n# New binary variable to linearize\r\n@variable(model, z[1:nbFac, 1:nbLoc, 1:nbFac, 1:nbLoc], Bin)\r\n\r\nfor j in 1:nbLoc\r\n    @constraint(model, sum(x[i, j] for i in 1:nbFac) == 1)\r\nend\r\n\r\nfor i in 1:nbFac\r\n    @constraint(model, sum(x[i, j] for j in 1:nbLoc) == 1)\r\nend\r\n\r\n# Added constraints to linearize\r\nfor i in 1:nbFac\r\n    for j in 1:nbLoc\r\n        for k in 1:nbFac\r\n            for r in 1:nbLoc\r\n                @constraint(model, z[i, j, k, r] <= x[i, j])\r\n                @constraint(model, z[i, j, k, r] <= x[k, r])\r\n                @constraint(model, z[i, j, k, r] >= x[i, j] + x[k, r] - 1)\r\n            end\r\n        end\r\n    end\r\nend\r\n\r\n@objective(model, Min, sum(flow[i, k] * distance[j, r] * z[i, j, k, r] for i = 1:nbFac for j = 1:nbLoc for k = 1:nbFac for r = 1:nbLoc))\r\n\r\nprint(model)\r\n\r\noptimize!(model)\r\n\r\nobjective_value(model)\r\n\r\nvalue.(x)\r\n\r\n\r\n\r\n\r\nAsghari, Mohammad, Amir M Fathollahi-Fard, SMJ Mirzapour Al-E-Hashem, and Maxim A Dulebenets. 2022. “Transformation and Linearization Techniques in Optimization: A State-of-the-Art Survey.” Mathematics 10 (2): 283.\r\n\r\n\r\nNahmias, Steven, and Tava Lennon Olsen. 2015. Production and Operations Analysis. Waveland Press.\r\n\r\n\r\nTompkins, James A, John A White, Yavuz A Bozer, and Jose Mario Azaña Tanchoco. 2010. Facilities Planning. John Wiley & Sons.\r\n\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2024-06-15T23:00:10-04:00",
    "input_file": "linearization-techniques-in-optimization-multiplication-of-binary-variables.knit.md"
  }
]
